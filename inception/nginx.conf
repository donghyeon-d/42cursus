user www-data;
worker_processes auto;
pid /run/nginx.pid;

events {
	worker_connections 768;
	multi_accept on;
}

http {
	server {
		listen 80;
		listen [::]:80;

		server_name	dongchoi.42.fr;
		return         301 https://$host$request_uri;
	}

	server {
		listen 443 ssl;
		listen [::]:443 ssl;
		server_name www.dongchoi.42.fr dongchoi.42.fr;
		
		ssl_protocols  TLSv1.2 TLSv1.3;
		ssl_certificate /etc/ssl/certs/server.crt;
		ssl_certificate_key /etc/ssl/private/server_pkey.pem;

		root /var/www/html;

		index index.php;


		# log files
		access_log /var/log/nginx/example.com.access.log;
		error_log /var/log/nginx/example.com.error.log;
		include /etc/nginx/mime.types;

		location = /favicon.ico {
			log_not_found off;
			access_log off;
		}

		location = /robots.txt {
			allow all;
			log_not_found off;
			access_log off;
		}

		location / {
			try_files $uri $uri/ /index.php?$args;
		}

		location ~ \.php$ {
			include snippets/fastcgi-php.conf;
			fastcgi_pass unix:/run/php/php7.3-fpm.sock;
		}

		location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {
			expires max;
			log_not_found off;
		}

	}
}